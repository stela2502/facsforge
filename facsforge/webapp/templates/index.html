<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FACSForge Web UI</title>

    <!-- Bootstrap (local hosting can be added later if needed) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <style>
        body {
            padding-top: 40px;
            background-color: #f5f5f5;
        }
        .config-box {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #ddd;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border: 1px solid #ccc;
            max-height: 400px;
            overflow-y: scroll;
        }
        .nav-button {
            width: 100%;
            margin-bottom: 15px;
            padding: 15px;
            font-size: 1.1rem;
        }
    </style>
</head>

<body>
<div class="container">

    <h1 class="mb-4 text-center">üî¨ FACSForge Web Interface</h1>

    <div class="row">
        <!-- Navigation -->
        <div class="col-md-4">
            <div class="config-box">
                <h4>Workflow Steps</h4>
                <hr>

                <a href="/panel" class="btn btn-primary nav-button">
                    1Ô∏è‚É£ Edit Panel (Markers & Roles)
                </a>

                <a href="/gates" class="btn btn-secondary nav-button">
                    2Ô∏è‚É£ Edit Gates & Cell Types
                </a>

                <a href="/umap" class="btn btn-info nav-button">
                    3Ô∏è‚É£ Configure UMAP / Clustering
                </a>

                <a href="/indexseq" class="btn btn-warning nav-button">
                    4Ô∏è‚É£ Index Sorting ‚Üí Sequencing Map
                </a>

                <a href="/reports" class="btn btn-success nav-button">
                    5Ô∏è‚É£ Generate Analysis Reports
                </a>

                <hr>

                <button id="saveBtn" class="btn btn-outline-dark w-100">
                    üíæ Save Configuration
                </button>
            </div>
        </div>

        <!-- Config preview -->
        <div class="col-md-8">
            <div class="config-box">
                <h4>Loaded Config Summary</h4>
                <p>
                    This is the YAML currently loaded into memory.
                    Editing is done through UI screens; this preview updates as you work.
                </p>

                <pre id="configPreview">{{ config | tojson(indent=2) }}</pre>
            </div>
        </div>
    </div>

</div>

<!-- Bootstrap & Fetch JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Save current config via /api/save
    document.getElementById("saveBtn").onclick = function() {
        fetch("/api/save", {
            method: "POST"
        })
        .then(r => r.json())
        .then(j => {
            alert("Configuration saved successfully!");
        })
        .catch(err => alert("Error saving: " + err));
    };
</script>

</body>
</html>

